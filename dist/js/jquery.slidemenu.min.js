/*
 Copyright 2014 Nathaniel Lord
 The MIT License (MIT)

 Copyright (c) 2014 Nathaniel Lord http://www.nathaniellord.com

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in all
 copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.
*/
'use strict';(function(b){var d=function(b,a){this.options=this.element=null;this.init("slideMenu",b,a)};d.VERSION="0.0.1";d.SLIDE_SPEED=.5;d.DEFAULTS={side:"right",panelDirection:"vertical",iconWidth:"",panelWidth:"",autoIconWidth:!0,autoPanelWidth:!0,initialized:!1,enabled:!0,show:!1,top:""};d.prototype.init=function(c,a,e){this.$element=b(a);this.options=this.getOptions(e);if(this.options.initialized)console.log("Menu is already initialized. Destroy the menu before trying to initialize again.");
else{this.$element.hasClass("left-side")&&(this.options.side="left");this.$element.hasClass("horizontal-open")&&(this.options.panelDirection="horizontal");if("complete"!==document.readyState)b(document).on("ready",this.resize());else this.resize();b(window).on("resize",this.resize());var d=0;b(".menu-item",this.$element).each(function(a,c){b(c).css("position","absolute");b(c).attr("data-index",a);b(c).css("top",d+"px");d+=b(c).height()});this.$element.off("click").on("click",".menu-item",this,this.menuClick)}};
d.prototype.menuClick=function(c){var a=c.data;b(c.currentTarget).hasClass("active")?a.close(c,a):b(c.currentTarget).parents(".slide-menu").hasClass("active")?a.switchMenus(c,a):a.openMenu(c,a)};d.prototype.getDefaults=function(){return d.DEFAULTS};d.prototype.getOptions=function(c){c=b.extend({},this.getDefaults(),this.$element.data(),c);""!==c.iconWidth&&(c.autoIconWidth=!1);""!==c.panelWidth&&(c.autoPanelWidth=!1);return c};d.prototype.resize=function(){var c=!1,a=0;"number"==typeof this.options.top&&
(a=this.options.top,this.$element.css("top",this.options.top+"px"));var e=b(window).height()-a;e!=this.$element.height()&&(c=!0);this.options.autoIconWidth&&b(".menu-icon",this.$element).outerWidth(!0)>this.options.iconWidth&&(this.options.iconWidth=b(".menu-icon",this.$element).outerWidth(!0),c=!0);this.options.autoPanelWidth&&b(".menu-panels",this.$element).width()!=this.options.panelWidth&&(this.options.panelWidth=b(".menu-panels",this.$element).width(),c=!0);this.options.width=this.options.panelWidth+
this.options.iconWidth;!1==this.options.show&&this.show();c&&(this.$element.width(this.options.width),this.$element.height(e).css("top",a),b(".menu-panels",this.$element).height(e),"right"==this.options.side&&(c=-this.options.iconWidth-parseInt(b(".menu-items",this.$element).css("border-left-width")),b(".menu-items",this.$element).css("left",c+"px"),this.$element.hasClass("active")?b(".menu-panels",this.$element).css("left",-this.options.width+"px"):"vertical"==this.options.panelDirection?b(".menu-panels",
this.$element).css("left",-this.options.width+"px").css("bottom","100%"):b(".menu-panels",this.$element).css("left","0px")),b(".menu-close",this.$element).css("width",this.options.iconWidth+"px"))};d.prototype.openMenu=function(c,a){a.$element.trigger("slidemenu.beforeOpen");a.$element.addClass("active");b(c.currentTarget).addClass("active");var e={};if("right"==a.options.side)var e=parseInt(b(".menu-items",a.$element).css("border-left-width")),d=parseInt(b(".menu-items",a.$element).css("left")),
e={left:parseInt(-a.options.width-d-e)+"px"};else"left"==a.options.side&&(d=parseInt(b(".menu-items",a.$element).css("left")),e={right:parseInt(-a.options.width+a.options.iconWidth)+"px"});b(".menu-item.active",a.$element).animate(e,{duration:250,complete:function(){"0px"!=b(".menu-item.active",a.$element).css("top")?a.reorder(function(){a.$element.trigger("slidemenu.opened");a.openPanel(b(c.currentTarget).data("target"))}):(a.$element.trigger("slidemenu.opened"),a.openPanel(b(c.currentTarget).data("target")))}})};
d.prototype.switchMenus=function(c,a){a.closePanel();var e={};if("right"==a.options.side)var e=parseInt(b(".menu-items",a.$element).css("border-left-width")),d=parseInt(b(".menu-items",a.$element).css("left")),e={left:parseInt(-a.options.width-d-e)+"px"};else"left"==a.options.side&&(d=parseInt(b(".menu-items",a.$element).css("left")),e={right:parseInt(-a.options.width+a.options.iconWidth)+"px"});b(c.currentTarget).stop().animate(e,{duration:250,complete:function(){a.reorder(function(){a.openPanel(b(c.currentTarget).data("target"))})}});
e={};"right"==a.options.side?e={left:"0px"}:"left"==a.options.side&&(e={right:"0px"});b(".menu-item.active",a.$element).animate(e,250,function(){b(this).removeClass("active")});b(".menu-item.active",a.$element).removeClass("active");b(c.currentTarget).addClass("active")};d.prototype.close=function(c){this.$element.trigger("slidemenu.beforeClose");var a=this,e={};"right"==a.options.side?e={left:"0px"}:"left"==this.options.side&&(e={right:"0px"});this.closePanel();b(".menu-item.active",a.$element).stop().animate(e,
{duration:250,complete:function(){a.$element.removeClass("active");a.$element.trigger("slidemenu.closed");"function"==typeof c&&c();b(".menu-item.active",a.$element).removeClass("active");a.reorder()}})};d.prototype.openPanel=function(c){b(".menu-panel.active",this.$element).removeClass("active");b(c,this.$element).addClass("active");b(".menu-panel.active",this.$element).css("padding-top",b(".menu-item.active",this.$element).outerHeight(!0)+"px");"vertical"==this.options.panelDirection?b(".menu-panels",
this.$element).animate({bottom:"0%"},250,"linear"):"horizontal"==this.options.panelDirection&&(c={},"right"==this.options.side?c={left:parseInt(-this.options.width)+"px"}:"left"==this.options.side&&(c={left:this.options.iconWidth+"px"}),b(".menu-panels",this.$element).stop().animate(c,250,"linear"))};d.prototype.closePanel=function(c){c={};var a=this;"right"==this.options.side?c={left:parseInt(-this.options.iconWidth)+"px"}:"left"==this.options.side&&(c={left:parseInt(-this.options.panelWidth+this.options.iconWidth)+
"px"});b(".menu-panels",a.$element).stop().animate(c,{duration:250,complete:function(){b(".menu-panel.active",a.$element).removeClass("active");"vertical"==a.options.panelDirection&&("right"==a.options.side?b(this).css("bottom","100%").css("left",-a.options.width+"px"):"left"==a.options.side&&b(this).css("bottom","100%").css("left",a.options.iconWidth+"px"))}})};d.prototype.open=function(c){b(".menu-item[data-target='"+c+"']",this.$element).click()};d.prototype.hide=function(c){function a(){"right"==
e.options.side?(b(".menu-panels",e.$element).css("left","0px"),b(".menu-items",e.$element).animate({left:"0px"},250)):(b(".menu-panels",e.$element).css("left","0px"),b(".menu-items",e.$element).animate({left:-e.options.width+"px"},250));e.options.show=!1}var e=this;this.isOpen()?e.close(function(){a()}):a()};d.prototype.show=function(c){if(!0!=this.options.show){var a=this;if(0==parseInt(b(".menu-items",a.$element).css("right"))||0==parseInt(b(".menu-items",a.$element).css("left")))if("right"==this.options.side){var e=
-a.options.iconWidth-parseInt(b(".menu-items",a.$element).css("border-left-width")),d={duration:250,complete:function(){"vertical"==a.options.panelDirection?b(".menu-panels",a.$element).css("left",-a.options.width+"px").css("bottom","100%"):"horizontal"==a.options.panelDirection&&b(".menu-panels",a.$element).css("left",e+"px").css("top","0px");a.options.show=!0;a.resize();"function"==typeof c&&c()}};b(".menu-items",a.$element).css("left","0px").animate({left:e+"px"},d)}else e=-a.options.width+a.options.iconWidth,
d={duration:250,complete:function(){"vertical"==a.options.panelDirection?b(".menu-panels",a.$element).css("left",a.options.iconWidth+"px").css("bottom","100%"):"horizontal"==options.panelDirection&&b(".menu-panels",a.$element).css("left",e+"px").css("top","0px");a.options.show=!0;a.resize();"function"==typeof c&&c()}},b(".menu-items",a.$element).css("left",-a.options.width+"px").animate({left:e+"px"},d);a.options.initialized=!0}};d.prototype.generateID=function(){for(var c=1,a="slidemenu-panel-"+
c;0<b("#"+a).length;)c++,a="slidemenu-panel-"+c;return a};d.prototype.addTab=function(c){var a=b(c.tab);c=b(c.content);void 0===b(c).attr("id")&&b(c).attr("id",this.generateID());b(a).attr("data-target",b(c).attr("id"));!1==b(a).hasClass("menu-item")&&b(a).addClass("menu-item");!1==b(c).hasClass("menu-panel")&&b(c).addClass("menu-panel");b(".menu-items",this.$element).append(a);b(".menu-panels",this.$element).append(c);this.reorder()};d.prototype.removeTab=function(c){b(".menu-item[data-target='"+
c+"']",this.$element).replaceWith("");b(c,this.$element).replaceWith("");this.reorder()};d.prototype.hideTab=function(c){if(b(".menu-item[data-target='"+c+"']",this.$element).hasClass("active")){var a=this;this.close(function(){b(".menu-item[data-target='"+c+"']",a.$element).hide()})}else b(".menu-item[data-target='"+c+"']",this.$element).hide(),this.reorder()};d.prototype.showTab=function(c){b(".menu-item[data-target='"+c+"']",this.$element).show();this.reorder()};d.prototype.changePosition=function(c){var a=
c.target;c=c.position;var e=b(".menu-item[data-target='"+a+"']",this.$element);b(".menu-item[data-target='"+a+"']",this.$element).replaceWith("");1==c?b(".menu-items",this.$element).prepend(e):b(".menu-item:nth-child("+parseInt(c-1)+")",this.$element).after(e);this.reorder()};d.prototype.reorder=function(c){var a=0;"0px"==b(".menu-item.active",this.$element).css("top")?"function"===typeof c&&c():0<b(".menu-item.active",this.$element).length&&(b(".menu-item.active",this.$element).animate({top:a+"px"},
{duration:250,complete:function(){"function"===typeof c&&c()}}),a+=b(".menu-item.active",this.$element).height());b(".menu-item:visible",this.$element).each(function(c,d){!1==b(d).hasClass("active")&&(b(d).animate({top:a+"px"},250),a+=b(d).height())})};d.prototype.disable=function(b){this.options.enabled=!1};d.prototype.enable=function(b){this.options.enabled=!0};d.prototype.isOpen=function(){return this.$element.hasClass("active")};d.prototype.destroy=function(){this.$element.css("width","").css("height",
"").css("top","");this.$element.find(".menu-items").css("left","");this.$element.find(".menu-panels").css("height","").css("left","").css("bottom","");this.$element.find(".menu-item").css("position","").css("top","").css("left","");this.$element.find(".menu-close").css("width","");this.$element.find(".menu-panel").css("padding-top","");delete this.options;delete this.$element};var g=b.fn.slidemenu;b.fn.slidemenu=function(c,a){return this.each(function(){var e=b(this),f=e.data("slidemenu"),g="object"==
typeof c&&c;f||e.data("slidemenu",f=new d(this,g));if("string"==typeof c)f[c](a)})};b.fn.slidemenu.Constructor=d;b.fn.slidemenu.noConflict=function(){b.fn.slidemenu=g;return this}})(jQuery);
